<div class="table-container">
  <table class="monitores-table">
    <thead>
      <tr>
        <th class="action-column">Acciones</th>
        <th>ID del<br>estudiante</th>
        <th>Nombre</th>
        <th>Apellido</th>
        <th>Carrera</th>
        <th>Semestre</th>
        <th>Promedio<br>Acumulado</th>
        <th *ngIf="!adminMode">Nombre del profesor<br>con quien tom√≥<br>la asignatura</th>
        <th *ngIf="!adminMode">No.<br>Clase</th>
        <th *ngIf="!adminMode">Nombre<br>Asignatura</th>
        <th *ngIf="!adminMode">Nota<br>Obtenida</th>
        <th *ngIf="adminMode">Secci√≥n<br>Acad√©mica</th>
        <th>Horas<br>Semanales</th>
        <th>Semanas</th>
        <th>Total<br>Horas</th>
        <th>Correo<br>Institucional</th>
        <th>ANTIGUO</th>
        <th *ngIf="showMonitorAdministrativo">Monitor<br>Administrativo</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let m of monitores; let i = index">
  <tr class="monitor-row" [ngClass]="{ 'row-accepted': m.estado === 'aceptado', 'row-rejected': m.estado === 'rechazado' }">
          <td class="action-column">
            <div class="row-actions">
              <button type="button" class="btn-delete" (click)="eliminarMonitor(m)" title="Eliminar">üóëÔ∏è</button>
            </div>
          </td>
          <td>{{ m.id }}</td>
          <td>{{ m.nombre }}</td>
          <td>{{ m.apellido }}</td>
          <td>{{ m.carrera }}</td>
          <td>{{ m.semestre }}</td>
          <td>{{ m.promedio }}</td>
          <td *ngIf="!adminMode">{{ m.profesor }}</td>
          <td class="editable-cell" *ngIf="!adminMode">
            <input 
              type="number" 
              class="table-input" 
              [(ngModel)]="m.noClase" 
              placeholder=""
            />
          </td>
          <td *ngIf="!adminMode">{{ m.asignatura }}</td>
          <td *ngIf="!adminMode">{{ m.nota }}</td>
          <td *ngIf="adminMode">{{ m.seccionAcademica || '-' }}</td>
          <td class="editable-cell">
            <input 
              type="number" 
              class="table-input" 
              [(ngModel)]="m.horasSemanales" 
              (change)="calcularTotal(m)" 
              placeholder=""
            />
          </td>
          <td class="editable-cell">
            <input 
              type="number" 
              class="table-input" 
              [(ngModel)]="m.semanas" 
              (change)="calcularTotal(m)" 
              placeholder=""
            />
          </td>
          <td class="total-horas">{{ m.totalHoras }}</td>
          <td>{{ m.correo }}</td>
          <td>{{ m.antiguo ? 'S√≠' : 'No' }}</td>
          <td *ngIf="showMonitorAdministrativo">{{ m.administrativo ? 'S√≠' : 'No' }}</td>
          
        </tr>

        <!-- Expander para horarios -->
        <tr class="expander-row" [ngClass]="{ 'row-accepted': m.estado === 'aceptado', 'row-rejected': m.estado === 'rechazado' }">
          <td [attr.colspan]="getColspan()">
            <div class="expander-inner">
              <button class="expander" type="button" (click)="m.showHorarios = !m.showHorarios">
                <span class="caret" [class.open]="m.showHorarios">‚ñ∏</span> Horarios
              </button>
            </div>
          </td>
        </tr>

        <!-- Bloque de horarios (solo si showHorarios) -->
        <tr *ngIf="m.showHorarios" [ngClass]="{ 'row-accepted': m.estado === 'aceptado', 'row-rejected': m.estado === 'rechazado' }">
          <td [attr.colspan]="getColspan()">
            <app-horarios-monitores [horarios]="m.horarios ?? []"></app-horarios-monitores>
          </td>
        </tr>
      </ng-container>
    </tbody>
  </table>
</div>

<!-- Popup de confirmaci√≥n de eliminaci√≥n -->
<app-pop-eliminar 
  [visible]="showDeleteModal"
  [monitorNombre]="monitorToDelete?.nombre || ''"
  [monitorApellido]="monitorToDelete?.apellido || ''"
  (confirm)="onConfirmDelete()"
  (cancelled)="onCancelDelete()">
</app-pop-eliminar>
