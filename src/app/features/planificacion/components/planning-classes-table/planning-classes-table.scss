/* =====================================================
  Estilos para la tabla de clases del módulo Planificación
  Archivo: planning-classes-table.component.scss
  Descripción: Define la apariencia y disposición de la
  tabla de clases, acciones, autocompletado y horarios.
  ===================================================== */

/* ==============================
  Anchos de columnas
  ============================== */
:host {
  --col-actions:120px;
  --col-id: 160px;
  --col-name: 320px;
  --col-section: 120px;
  --col-class-id: 140px;
  --col-seats: 100px;
  --col-start: 150px;
  --col-end: 150px;
  --col-weeks: 110px;
  --col-teacher: 200px;
  --col-status: 150px;
  --col-observations: 140px;
}

/* ==============================
  Contenedor principal de la tabla
  ============================== */
.tabla-wrap {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: #fff;
  overflow-x: auto;
  overflow-y: visible;
}

/* ==============================
  Estilos de la tabla principal
  ============================== */
.tabla {
  width: 100%;
  min-width: 1600px;
  border-collapse: collapse;
  table-layout: fixed;

  thead th {
    height: 44px;
    line-height: 44px;
    padding: 0 12px;
    background: var(--muted);
    text-align: left;
    font-weight: 700;
    white-space: nowrap;
    border-bottom: 1px solid var(--border);
  }

  tbody td {
    padding: 8px 12px;
    vertical-align: middle;
    border-bottom: 1px solid var(--border);
    position: relative;
  }

  tbody tr:last-child td {
    border-bottom: none;
  }

  /* Eliminar borde inferior de la fila principal cuando va seguida de una fila expander */
  tbody tr:has(+ .expander-row) td,
  tbody tr.main-row td {
    border-bottom: none;
  }

  tbody tr.is-deleted { 
    opacity: .5; 
  }
}

.tabla col.c-actions { width: var(--col-actions); }
.tabla col.c-id      { width: var(--col-id); }
.tabla col.c-name    { width: var(--col-name); }
.tabla col.c-section { width: var(--col-section); }
.tabla col.c-class-id { width: var(--col-class-id); }
.tabla col.c-seats   { width: var(--col-seats); }
.tabla col.c-start   { width: var(--col-start); }
.tabla col.c-end     { width: var(--col-end); }
.tabla col.c-weeks   { width: var(--col-weeks); }
.tabla col.c-teacher { width: var(--col-teacher); }
.tabla col.c-status  { width: var(--col-status); }
.tabla col.c-observations { width: var(--col-observations); }

/* ==============================
  Sección de acciones (botones)
  ============================== */
.acciones {
  display: flex;
  flex-direction: row;
  align-items: center; /* centrado vertical */
  justify-content: flex-start; /* alineados a la izquierda dentro de la celda */
  gap: 6px;
  height: 100%;
  min-height: 44px; /* asegura altura similar a otras celdas */
  padding-top: 0;
  padding-bottom: 0;
}

/* Botón circular para acciones rápidas */
.btn-icon {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: 1px solid var(--border);
  background: var(--brand-azul);
  font-weight: 700;
  font-size: 16px;
  line-height: 1;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  color: #fff;
  transition: background .15s ease;

  &:hover { 
    background: var(--muted); 
  }

  /* Botones de editar y guardar con fondo blanco */
  &.btn-edit,
  &.btn-save {
    background: #fff;
    border: 2px solid var(--brand-azul);
    color: var(--brand-azul);

    &:hover {
      background: #f8f9fa;
    }
  }
}

/* ==============================
  Estilos de inputs para edición
  ============================== */
.input {
  width: 100%;
  height: 36px;
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 0 10px;
  font: inherit;
  background: #fff;
  outline: none;

  &:focus {
    border-color: var(--brand-azul);
    box-shadow: 0 0 0 2px rgba(44,86,151,.15);
  }

  // Estilo para campos calculados automáticamente (solo lectura)
  &[readonly] {
    background-color: #f8f9fa;
    border-color: #e9ecef;
    color: #6c757d;
    cursor: not-allowed;
    
    &:focus {
      border-color: #e9ecef;
      box-shadow: none;
    }
  }
}

/* ==============================
  Autocompletado de cursos (sugerencias)
  ============================== */
.cell-autocomplete { 
  position: relative; 
}

.suggest {
  position: absolute;
  left: 0; 
  right: 0; 
  top: calc(100% + 4px);
  max-height: 220px;
  overflow: auto;
  background: #fff;
  border: 1px solid var(--border);
  border-radius: 8px;
  z-index: 10;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);

  li {
    display: grid;
    grid-template-columns: 100px 1fr;
    gap: 8px;
    padding: 8px 10px;
    cursor: pointer;

    &:hover { 
      background: var(--muted); 
    }

    .id   { 
      color: var(--text-700); 
      font-weight: 600; 
    }
    
    .name { 
      color: var(--text-700); 
    }
  }
}

/* ==============================
  Contenedor de edición de docente
  ============================== */
.teacher-edit-container {
  display: flex;
  align-items: center;
  gap: 8px;

  .input {
    flex: 1;
  }

  .btn-add-teacher {
    width: 32px;
    height: 32px;
    min-width: 32px;
    background: #28a745;
    border-color: #28a745;
    font-size: 18px;
    font-weight: bold;

    &:hover {
      background: #218838;
    }
  }
}

/* Estilos para botones pequeños en columna docente */
.btn-sm {
  padding: 4px 8px;
  font-size: 12px;
  margin-left: 8px;
}

/* Sección de solo lectura */
.section-readonly {
  color: var(--text-600);
  font-style: italic;
  padding: 8px 0;
  display: block;
}

/* ==============================
  Estados de clase
  ============================== */
.status-pending {
  color: #f39c12;
}

.status-confirmed {
  color: #2ecc71;
}

.status-rejected {
  color: #e74c3c;
}

/* ==============================
  Botones de acción
  ============================== */
.btn--primary {
  background: var(--brand-azul);
  color: white;
  border: none;
  padding: 8px 12px;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.3s ease;

  &:hover:not(:disabled) {
    background: #1e4076;
  }

  &:disabled {
    background: #6c757d; /* Gris cuando está deshabilitado */
    color: #adb5bd; /* Texto más claro */
    cursor: not-allowed;
    opacity: 0.65;
  }
}

.btn--secondary {
  background: #6c757d;
  color: white;
  border: none;
  padding: 8px 12px;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.3s ease;

  &:hover {
    background: #5a6268;
  }
}

/* ==============================
  Fila de sub-horarios (desplegable)
  ============================== */
.expander-row td {
  background: transparent; /* sin fondo directo */
  padding: 0 !important;   /* eliminamos padding para ancho completo */
}
.expander-row td .expander-inner {
  background: #eef1f4;
  padding: 8px 12px 4px 12px; /* mantenemos coherencia interna con el resto de la tabla */
}
.expander-row td .separator-line.separator-under {
  margin: 0; 
  width: 100%;
  display: block;
}

/* ==============================
  Línea separadora para las filas expandibles
  ============================== */
.separator-line {
  border-bottom: 1px solid var(--border);  /* Reducimos a 1px para que coincida con el resto */
  margin: 0 0 12px 0;
  width: 100%;
}

/* Estilo cuando la línea va debajo del botón Horarios */
.separator-line.separator-under {
  margin: 8px 0 4px 0; /* pequeño espacio arriba y menos abajo para continuidad visual */
}

/* Opcional: cuando el bloque de horarios está abierto, reducir margen inferior para unir visualmente */
tr + tr.expander-row + tr[ngif] .separator-line.separator-under {
  margin-bottom: 2px;
}

/* Botón expander con icono y texto */
.expander {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  color: var(--text-700);
  font-weight: 600;
  background: transparent;
  border: 0;
  cursor: pointer;
  padding: 4px 0;
}

/* Icono caret para indicar expansión de sub-horarios */
.caret {
  display: inline-block;
  transition: transform .15s ease;

  &.open {
    transform: rotate(90deg);
  }
}
